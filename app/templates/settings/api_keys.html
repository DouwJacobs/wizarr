<div id="create-api-key-modal"></div>

<section class="py-8 animate__animated animate__fadeIn">
    <div class="container px-4 mx-auto">
        <div class="flex items-center justify-between mb-6">
            <h1 class="text-2xl font-bold text-gray-900 dark:text-white">
                {{ _("API Keys") }}
            </h1>
            <button hx-get="{{ url_for('api_keys.create_api_key') }}"
                    hx-target="#create-api-key-modal"
                    hx-trigger="click"
                    _="on htmx:afterOnLoad wait 10ms then remove .hidden to #modal"
                    class="inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800">
                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                </svg>
                {{ _("Create API Key") }}
            </button>
        </div>

        {% if api_keys %}
        <div class="grid grid-cols-1 gap-4 animate__animated" id="api_keys_grid">
            {% for key in api_keys %}
            <div class="flex items-center justify-between bg-white dark:bg-gray-800 rounded-lg shadow-xs p-4 border border-gray-200 dark:border-gray-700" data-key-id="{{ key.id }}">
                <div class="flex items-center gap-3">
                    <svg class="w-6 h-6 text-gray-500 dark:text-gray-400" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M7 14c-1.66 0-3 1.34-3 3 0 1.31.84 2.41 2 2.83V21h2v-1.17c1.16-.42 2-1.52 2-2.83 0-1.66-1.34-3-3-3zM20.5 10.5c-.28 0-.5.22-.5.5s.22.5.5.5.5-.22.5-.5-.22-.5-.5-.5zm0-2c1.38 0 2.5 1.12 2.5 2.5s-1.12 2.5-2.5 2.5S18 12.38 18 11s1.12-2.5 2.5-2.5zM9 11V8.5c0-.83.67-1.5 1.5-1.5S12 7.67 12 8.5V11h2V8.5C14 6.57 12.43 5 10.5 5S7 6.57 7 8.5V11H6c-.55 0-1 .45-1 1v7c0 .55.45 1 1 1h9c.55 0 1-.45 1-1v-7c0-.55-.45-1-1-1H9z"/>
                    </svg>
                    <div>
                        <span class="text-gray-900 dark:text-white font-medium">{{ key.name }}</span>
                        <div class="text-sm text-gray-500 dark:text-gray-400">
                            Created: {{ key.created_at.strftime('%Y-%m-%d %H:%M') }}
                            {% if key.last_used_at %}
                            | Last used: {{ key.last_used_at.strftime('%Y-%m-%d %H:%M') }}
                            {% else %}
                            | Never used
                            {% endif %}
                        </div>
                    </div>
                </div>
                <div class="space-x-2">
                    <form method="POST" action="{{ url_for('api_keys.delete_api_key', key_id=key.id) }}" class="inline-block">
                        <button type="submit"
                                onclick="return confirm('Are you sure you want to delete this API key? This action cannot be undone.')"
                                class="inline-flex items-center justify-center p-2 text-red-600 rounded-lg hover:text-red-800 hover:bg-red-100 dark:text-red-400 dark:hover:text-red-300 dark:hover:bg-red-900"
                                title="{{ _('Delete API Key') }}">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                                      d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                            </svg>
                        </button>
                    </form>
                </div>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <div class="text-center py-12">
            <svg class="mx-auto h-12 w-12 text-gray-400 dark:text-gray-500" stroke="currentColor" fill="none" viewBox="0 0 48 48">
                <path d="M25 17l-7 7-7-7m14-8v22m0-22l7 7-7-7m-14 15h22a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v24a2 2 0 002 2z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <h3 class="mt-2 text-sm font-medium text-gray-900 dark:text-white">{{ _("No API keys") }}</h3>
            <p class="mt-1 text-sm text-gray-500 dark:text-gray-400">{{ _("Get started by creating a new API key.") }}</p>
        </div>
        {% endif %}
    </div>
</section>